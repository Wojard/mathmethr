<!DOCTYPE html>
<html>
<head>
  <title>Анализ мощности</title>

  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="generator" content="pandoc" />




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">

  <link rel="stylesheet" media="all" href="site_libs/ioslides-13.5.1/fonts/fonts.css">

  <link rel="stylesheet" media="all" href="site_libs/ioslides-13.5.1/theme/css/default.css">
  <link rel="stylesheet" media="only screen and (max-device-width: 480px)" href="site_libs/ioslides-13.5.1/theme/css/phone.css">

  <base target="_blank">

  <script type="text/javascript">
    var SLIDE_CONFIG = {
      // Slide settings
      settings: {
                title: 'Анализ мощности',
                        subtitle: 'Математические методы в зоологии с использованием R',
                useBuilds: true,
        usePrettify: true,
        enableSlideAreas: true,
        enableTouch: true,
                      },

      // Author information
      presenters: [
            {
        name:  'Марина Варфоломеева' ,
        company: '',
        gplus: '',
        twitter: '',
        www: '',
        github: ''
      },
            ]
    };
  </script>

  <style type="text/css">

    b, strong {
      font-weight: bold;
    }

    em {
      font-style: italic;
    }

    slides > slide {
      -webkit-transition: all 0.4s ease-in-out;
      -moz-transition: all 0.4s ease-in-out;
      -o-transition: all 0.4s ease-in-out;
      transition: all 0.4s ease-in-out;
    }

    .auto-fadein {
      -webkit-transition: opacity 0.6s ease-in;
      -webkit-transition-delay: 0.4s;
      -moz-transition: opacity 0.6s ease-in 0.4s;
      -o-transition: opacity 0.6s ease-in 0.4s;
      transition: opacity 0.6s ease-in 0.4s;
      opacity: 0;
    }

  </style>

  <link rel="stylesheet" href="assets/my_styles.css" type="text/css" />

</head>

<body style="opacity: 0">

<slides class="layout-widescreen">

  <slide class="title-slide segue nobackground">
        <!-- The content of this hgroup is replaced programmatically through the slide_config.json. -->
    <hgroup class="auto-fadein">
      <h1 data-config-title><!-- populated from slide_config.json --></h1>
      <h2 data-config-subtitle><!-- populated from slide_config.json --></h2>
      <p data-config-presenter><!-- populated from slide_config.json --></p>
          </hgroup>
  </slide>

<slide class=''><hgroup><h2>Экономим силы с помощью анализа мощности</h2></hgroup><article  id="-----">

<ul>
<li>Тестирование гипотез (двухвыборочный t-критерий)</li>
<li>Статистические ошибки при проверке гипотез</li>
<li>Мощность статистического теста</li>
<li><em>A priori</em> анализ мощности, оценка величины эффекта</li>
<li>Как влиять на мощность тестов</li>
</ul>

<h3>Вы сможете</h3>

<ul>
<li>сравнивать средние значения при помощи t-критерия, интерпретировать и описывать результаты</li>
<li>дать определение ошибок I и II рода, и графически изобразить их отношение к мощности теста</li>
<li>оценивать величину эффекта и необходимый объем выборки по данным пилотного исследования</li>
<li>загружать данные из .xls в R</li>
<li>строить боксплоты с помощью <code>ggplot2</code></li>
</ul>

</article></slide><slide class='segue dark nobackground level1'><hgroup class = 'auto-fadein'><h2>Тестирование гипотез</h2></hgroup><article  id="-">

</article></slide><slide class=''><hgroup><h2>Тест Стьюдента (t-критерий)</h2></hgroup><article  id="--t-">

<p>Двухвыборочный тест Стьюдента (Student, 1908) используется для проверки значимости различий между средними значениями двух нормально распределенных величин.</p>

<p>\[t=\frac{\bar{\mu}_1 - \bar{\mu}_2}{SE}\]</p>

<p>Гипотезы: \(H_0: \mu_1 = \mu_2\), \(H_A: \mu_1 \ne \mu_2\)</p>

<p>Условия применимости:</p>

<ul>
<li>Выборки случайны и независимы друг от друга</li>
<li>Величины нормально распределены</li>
<li>Дисперсии в группах одинаковы</li>
</ul>

<p>\[SE = \sqrt{\frac{sd_1^2(n_1-1) +sd_2^2(n_2-1)}{n_1+n_2-2}\Big(\frac{1}{n_1} + \frac{1}{n_2}\Big)}\]</p>

<p>\[df = n_1 + n_2 - 2\]</p>

</article></slide><slide class=''><hgroup><h2>Тест Уэлча (модификация теста Стьюдента для случая разных дисперсий)</h2></hgroup><article  id="--------">

<p>\[t=\frac{\bar{\mu}_1 - \bar{\mu}_2}{SE}\]</p>

<p>Условия применимости:</p>

<ul>
<li>Выборки случайны и независимы друг от друга</li>
<li>Величины нормально распределены</li>
</ul>

<p>\[SE = \sqrt{\frac {sd_1^2} {n_1} + \frac {sd_2^2} {n_2}}\]</p>

<p>Приблизительное число степеней свободы рассчитывается по уравнению Уэлча-Саттеруэйта (Welch–Satterthwaite equation)</p>

<p>\[df \approx \frac {\Big(\frac{sd^2_1}{n_1} + \frac{sd^2_2}{n_2}\Big)^2} {\frac {sd_1^4} {n^2_1 \cdot df_1} + \frac {sd_2^4} {n^2_2 \cdot df_1}}\]</p>

</article></slide><slide class=''><hgroup><h2>t-распределение</h2></hgroup><article  id="t-">

<p>t-статистика подчиняется t-распределению.</p>

<p>Иными словами, если много раз взять выборки <strong>из одной</strong> совокупности (т.е. при условии, что \(H_0\) верна) и посчитать между ними разницу, то она будет подчиняться t-распределению.</p>

<p>Форма t-распределения зависит только от одного параметра &#8212; числа степеней свободы \(df\)</p>

<p><img src="02_power_files/figure-html/gg-t-1.png" width="672" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2>В хвостах этого распределения находятся редкие значения</h2></hgroup><article  id="------">

<p><img src="02_power_files/figure-html/gg-tcrit-1.png" width="672" style="display: block; margin: auto;" /></p>

<p>Обычно используется уровень значимости \(\alpha\) 0.05 или 0.01.</p>

<p><strong>Уровень значимости \(\alpha\) &#8212; это вероятность ошибочно отвергнуть справедливую нулевую гипотезу</strong>. Т.е. это вероятность найти различия там, где их нет (<strong>вероятность ошибки I рода</strong>).</p>

<p>Для t-теста \(\alpha\) &#8212; это вероятность ошибочно сделать вывод о том, что средние выборок различаются <strong>при условии, что эти выборки получены из одной генеральной совокупности</strong>.</p>

</article></slide><slide class=''><hgroup><h2>Тестирование гипотезы о равенстве двух средних при помощи t-критерия</h2></hgroup><article  id="--------t-">

<ul>
<li>Для конкретных данных считаем значение t-критерия</li>
<li>Сравниваем его с теоретическим распределением t (распределением при условии, что \(H_0\) верна)</li>
<li>Принимаем решение, отвергнуть ли \(H_0\)</li>
</ul>

<p><img src="02_power_files/figure-html/gg-tcrit-h-1.png" width="672" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2>Пример: Снотворное</h2></hgroup><article  id="-">

<p>В датасете <code>sleep</code> содержатся данные об увеличении продолжительности сна по сравнению с контролем после применения двух снотворных препаратов (Cushny, Peebles, 1905, Student, 1908)</p>

<pre class = 'prettyprint lang-r'>data(sleep)
View(sleep)</pre>

</article></slide><slide class=''><hgroup><h2>Двухвыборочный t-критерий</h2></hgroup><article  id="-t-">

<p>Сравним увеличение продолжительности сна при помощи двухвыборочного t-критерия.</p>

<pre class = 'prettyprint lang-r'>tt &lt;- t.test(extra ~ group, sleep)
tt</pre>

<pre >## 
##  Welch Two Sample t-test
## 
## data:  extra by group
## t = -1.8608, df = 17.776, p-value = 0.07939
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -3.3654832  0.2054832
## sample estimates:
## mean in group 1 mean in group 2 
##            0.75            2.33</pre>

</article></slide><slide class=''><hgroup><h2>Что спрятано в результатах?</h2></hgroup><article  id="---">

<p>Как называются отдельные элементы результатов можно узнать посмотрев их структуру при помощи функции <code>str()</code></p>

<pre class = 'prettyprint lang-r'>str(tt)</pre>

<pre >## List of 9
##  $ statistic  : Named num -1.86
##   ..- attr(*, &quot;names&quot;)= chr &quot;t&quot;
##  $ parameter  : Named num 17.8
##   ..- attr(*, &quot;names&quot;)= chr &quot;df&quot;
##  $ p.value    : num 0.0794
##  $ conf.int   : atomic [1:2] -3.365 0.205
##   ..- attr(*, &quot;conf.level&quot;)= num 0.95
##  $ estimate   : Named num [1:2] 0.75 2.33
##   ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;mean in group 1&quot; &quot;mean in group 2&quot;
##  $ null.value : Named num 0
##   ..- attr(*, &quot;names&quot;)= chr &quot;difference in means&quot;
##  $ alternative: chr &quot;two.sided&quot;
##  $ method     : chr &quot;Welch Two Sample t-test&quot;
##  $ data.name  : chr &quot;extra by group&quot;
##  - attr(*, &quot;class&quot;)= chr &quot;htest&quot;</pre>

</article></slide><slide class=''><hgroup><h2>Можно получить элементы результатов в виде отдельных цифр</h2></hgroup><article  id="-------">

<pre class = 'prettyprint lang-r'>tt$parameter # степени свободы</pre>

<pre >##       df 
## 17.77647</pre>

<pre class = 'prettyprint lang-r'>tt$p.value # доверительная вероятность</pre>

<pre >## [1] 0.07939414</pre>

<pre class = 'prettyprint lang-r'>tt$statistic # значение t-критерия</pre>

<pre >##         t 
## -1.860813</pre>

</article></slide><slide class='segue dark nobackground level1'><hgroup class = 'auto-fadein'><h2>Статистические ошибки при проверке гипотез</h2></hgroup><article  id="----">

</article></slide><slide class=''><hgroup><h2>Типы ошибок при проверке гипотез</h2></hgroup><article  id="----">

<table class = 'rmdtable'>
<col width="8%" />
<col width="8%" />
<col width="8%" />
<tr class="header">
<th align="left"></th>
<th align="left">H0 == TRUE</th>
<th align="left">H0 == FALSE</th>
</tr>
<tr class="odd">
<td align="left">Отклонить H0</td>
<td align="left">Ошибка I рода </br>Ложно-положительный результат</td>
<td align="left">Верно </br>Положительный результат</td>
</tr>
<tr class="even">
<td align="left">Сохранить H0</td>
<td align="left">Верно </br>Отрицательный результат</td>
<td align="left">Ошибка II рода </br> Ложно-отрицательный результат</td>
</tr>
</table>

</article></slide><slide class=''><hgroup><h2>Ошибка I рода</h2></hgroup><article  id="-i-">

<p><img src="02_power_files/figure-html/power_alpha-1.png" width="969.6" style="display: block; margin: auto;" /></p>

<p><strong>Ошибка I рода &#8212; вероятность отвергнуть \(H_0\), когда верна \(H_0\)</strong></p>

</article></slide><slide class=''><hgroup><h2>Мы этого не знаем, но может быть верна \(H_A\)&#8230;</h2></hgroup><article  id="--------h_a...">

<p><img src="02_power_files/figure-html/power_alternative-1.png" width="969.6" style="display: block; margin: auto;" /></p>

<p>Можно построить еще одно распределение статистики &#8212; распределение, при условии того, что верна \(H_A\)</p>

</article></slide><slide class=''><hgroup><h2>Ошибка II рода</h2></hgroup><article  id="-ii-">

<p><img src="02_power_files/figure-html/power_beta-1.png" width="969.6" style="display: block; margin: auto;" /> <strong>Ошибка II рода &#8212; вероятность принять \(H_0\), когда верна \(H_A\)</strong></p>

</article></slide><slide class=''><hgroup><h2>Мощность теста &#8212; способность выявлять различия</h2></hgroup><article  id="--------">

<p><img src="02_power_files/figure-html/power-power-1.png" width="969.6" style="display: block; margin: auto;" /></p>

<p><strong>Мощность теста - вероятность отвергнуть \(H_0\), когда верна \(H_А\)</strong></p>

<p>\[Power = 1 - \beta\]</p>

<p>Обычно считается, что хорошо, когда мощность не меньше 0.8</p>

<p>Т.е. что в 80% случаев мы можем найди различия заданной величины, если они есть.</p>

</article></slide><slide class=''><hgroup><h2>Анализ мощности</h2></hgroup><article  id="-">

<div class="columns-2">
<center>

<em>A priori</em>

</center>

<ul>
<li>какой нужен объем выборки, чтобы найти различия с разумной долей уверенности?</li>
<li>различия какой величины мы можем найти, если известен объем выборки?</li>
</ul>

<center>

<em>Post hoc</em>

</center>

<ul>
<li>смогли бы мы найти различия при помощи нашего эксперимента (\(\alpha\), \(n\)), если бы величина эффекта была \(X\)?</li>
</ul>

<p></br></p></div>

</article></slide><slide class='segue dark nobackground level1'><hgroup class = 'auto-fadein'><h2>A priory анализ мощности</h2></hgroup><article  id="a-priory--">

</article></slide><slide class=''><hgroup><h2>Пример: Заповедник спасает халиотисов*</h2></hgroup><article  id="---">

<p>Лов халиотисов (коммерческий и любительский) запретили, организовав заповедник.</p>

<p>Стало ли больше моллюсков через несколько лет? (Keough, King, 1991)</p>

<div class = "footnote">

<ul>
<li><ul>
<li>Данные из Quinn, Keough, 2002, Box 9-5, Fig 9-7

</div></li>
</ul></li>
</ul>

</article></slide><slide class=''><hgroup><h2>A priori анализ мощности</h2></hgroup><article  id="a-priori--" class="column-2">

<p>Что нужно</p>

<ul>
<li>тест</li>
<li>уровень значимости</li>
<li>желаемая мощность теста—80%</li>
<li>ожидаемая величина эффекта</li>
</ul>

<p></br></p>

<ul>
<li>\(t\)-критерий</li>
<li>\(alpha = 0.05\)</li>
<li>P = 80%</li>
<li>?</li>
</ul>

</article></slide><slide class=''><hgroup><h2>Величина эффекта</h2></hgroup><article  id="-">

<p>\(d\) Коэна (Cohen&#39;s d)</p>

<p><br /> \[d = \frac{\bar \mu_1 - \bar \mu_2}{\sigma}\]</p>

<p>Где сигма может оцениваться одним из способов:</p>

<ul>
<li>среднеквадратичное отклонение (\(d\) Коэна)</li>
</ul>

<p>\(\sigma = {\sqrt{\frac {s_1^2 + s_2^2 } {2} }}\)</p>

<ul>
<li>обобщенное стандартное отклонение (\(g\) Хеджа)</li>
</ul>

<p>\(\sigma = {\sqrt{\frac {(n _1 - 1)s_1^2 + (n _2 - 1)s_2^2 } {n _1 + n _2 - 2} } }\)</p>

</article></slide><slide class=''><hgroup><h2>Величина эффекта</h2></hgroup><article  id="--1">

<p>Яков Коэн предложил делить эффекты на сильные, умеренные и слабые (Cohen, 1982)</p>

<pre class = 'prettyprint lang-r'>library(pwr)
cohen.ES(test = &quot;t&quot;, size = &quot;large&quot;)</pre>

<pre >## 
##      Conventional effect size from Cohen (1982) 
## 
##            test = t
##            size = large
##     effect.size = 0.8</pre>

</article></slide><slide class=''><hgroup><h2>Задание</h2></hgroup><article >

<p>Рассчитайте величину умеренных и слабых эффектов для t-критерия</p>

</article></slide><slide class=''><hgroup><h2>Решение</h2></hgroup><article >

<pre class = 'prettyprint lang-r'>cohen.ES(test = &quot;t&quot;, size = &quot;medium&quot;)</pre>

<pre >## 
##      Conventional effect size from Cohen (1982) 
## 
##            test = t
##            size = medium
##     effect.size = 0.5</pre>

<pre class = 'prettyprint lang-r'>cohen.ES(test = &quot;t&quot;, size = &quot;small&quot;)</pre>

<pre >## 
##      Conventional effect size from Cohen (1982) 
## 
##            test = t
##            size = small
##     effect.size = 0.2</pre>

</article></slide><slide class=''><hgroup><h2>Величина эффекта из пилотных данных</h2></hgroup><article  id="----">

<p>\[d = \frac{\bar \mu_1 - \bar \mu_2}{\sigma}\]</p>

<p>\({\sigma}\) - cтандартное отклонение плотности халиотисов:</p>

<ul>
<li>Плотность крупных халиотисов на \(50 м^2\) была \(\bar x = 47.5\), \(SD = 27.7\)</li>
</ul>

<p>\({\bar \mu_1 - \bar \mu_2}\) - cредний вылов халиотисов в год:</p>

<ul>
<li>Масса выловленных коммерческим способом + данные о размерах -&gt; численность -&gt; плотность

<ul>
<li>Предположили, что коммерческий лов и любительский лов равны</li>
<li>Коммерческий лов = 11.6 экз. \(м^{-2}\)</li>
<li>Коммерческий + любительский лов = 23.2 экз. \(м^{-2}\)</li>
</ul></li>
</ul>

</article></slide><slide class=''><hgroup><h2>Данные для анализа мощности собраны</h2></hgroup><article  id="----">

<pre class = 'prettyprint lang-r'>alpha &lt;- 0.05
power &lt;- 0.80
sigma &lt;- 27.7 # варьирование плотности халиотисов
diff &lt;- 23.2 # ожидаемые различия плотности халиотисов
effect &lt;- diff/sigma # величина эффекта
effect</pre>

<pre >## [1] 0.8375451</pre>

<p>Функции для анализа мощности t-критерия:</p>

<ul>
<li>при одинаковых объемах групп <code>pwr.t.test()</code></li>
<li>при разных объемах групп <code>pwr.t2n.test()</code></li>
</ul>

</article></slide><slide class=''><hgroup><h2>Считаем объем выборки</h2></hgroup><article  id="--">

<pre class = 'prettyprint lang-r'>pwr_hal &lt;- pwr.t.test(n = NULL, 
                      d = effect, 
                      power = power, 
                      sig.level = alpha, 
                      type = &quot;two.sample&quot;, 
                      alternative = &quot;two.sided&quot;)
pwr_hal</pre>

<pre >## 
##      Two-sample t test power calculation 
## 
##               n = 23.37829
##               d = 0.8375451
##       sig.level = 0.05
##           power = 0.8
##     alternative = two.sided
## 
## NOTE: n is number in *each* group</pre>

<ul class = 'build'>
<li>Чтобы с вероятностью 0.8 выявить различия плотности халиотисов в местах, где лов разрешен и запрещен, нужно обследовать <strong>по 24 пробы каждого типа</strong>, если мы верно оценили величину эффекта.</li>
</ul>

</article></slide><slide class=''><hgroup><h2>Задание</h2></hgroup><article  id="-1">

<p>Рассчитайте сколько нужно обследовать проб, чтобы обнаружить слабый эффект с вероятностью 0.8, при уровне значимости 0.01</p>

<p>Вам понадобятся функции <code>cohen.ES()</code> и <code>pwr.t.test()</code></p>

</article></slide><slide class=''><hgroup><h2>Решение</h2></hgroup><article  id="-1">

<pre class = 'prettyprint lang-r'>cohen.ES(test = &quot;t&quot;, size = &quot;small&quot;)</pre>

<pre >## 
##      Conventional effect size from Cohen (1982) 
## 
##            test = t
##            size = small
##     effect.size = 0.2</pre>

<pre class = 'prettyprint lang-r'>pwr.t.test(n = NULL, d = 0.2, 
           power = 0.8, sig.level = 0.01,
           type = &quot;two.sample&quot;, 
           alternative = &quot;two.sided&quot;)</pre>

<pre >## 
##      Two-sample t test power calculation 
## 
##               n = 585.6093
##               d = 0.2
##       sig.level = 0.01
##           power = 0.8
##     alternative = two.sided
## 
## NOTE: n is number in *each* group</pre>

</article></slide><slide class=''><hgroup><h2>Пример: Улитки на устрицах в мангровых зарослях*</h2></hgroup><article  id="------">

<p>В каких зонах мангровых зарослей на устрицах предпочитают обитать улитки (Minchinton, Ross, 1999)?</p>

<ul>
<li>Факторы:

<ul>
<li>Сайт (A и B)</li>
<li>Зона зарослей (LZ - ближе к земле, MZ - средняя часть, SZ(+TR)с деревьями, SZ(-TR) - ближе к морю, без деревьев)</li>
</ul></li>
<li>Собрали по 5 проб - число улиток на раковинах устриц</li>
</ul>

<div class = "footnote">

<ul>
<li><ul>
<li>Данные из Quinn, Keough, 2002, Box 9-5, Fig 9-7

</div></li>
</ul></li>
</ul>

</article></slide><slide class=''><hgroup><h2>Скачиваем данные с сайта</h2></hgroup><article  id="---">

<p>Не забудьте войти в вашу директорию для матметодов при помощи <code>setwd()</code></p>

<pre class = 'prettyprint lang-r'>library(downloader)

# в рабочем каталоге создаем суб-директорию для данных
if(!dir.exists(&quot;data&quot;)) dir.create(&quot;data&quot;)

# скачиваем файл
download(
  url = &quot;https://varmara.github.io/mathmethr/data/minch.xls&quot;, 
  destfile = &quot;data/minch.xls&quot;)</pre>

</article></slide><slide class=''><hgroup><h2>Читаем данные из файла</h2></hgroup><article  id="---">

<pre class = 'prettyprint lang-r'>library(readxl)
minch &lt;- read_excel(path = &quot;data/minch.xls&quot;, sheet = 1)</pre>

<pre class = 'prettyprint lang-r'>str(minch) # Структура данных</pre>

<pre >## Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:    40 obs. of  6 variables:
##  $ NA      : chr  &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ site    : chr  &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; ...
##  $ zone    : chr  &quot;SZ(-TR)&quot; &quot;SZ(-TR)&quot; &quot;SZ(-TR)&quot; &quot;SZ(-TR)&quot; ...
##  $ limpt   : num  0.16 0.11 0.1 0.16 0.15 0.12 0 0.03 0.05 0.43 ...
##  $ limpt100: num  16 11 10 16 15 12 0 3 5 43 ...
##  $ sqlim100: num  4 3.32 3.16 4 3.87 ...</pre>

</article></slide><slide class=''><hgroup><h2>Просмотреть, что получилось можно так:</h2></hgroup><article  id="----">

<pre class = 'prettyprint lang-r'>head(minch)     # Первые несколько строк файла</pre>

<pre >## # A tibble: 6 × 6
##      NA  site    zone limpt limpt100 sqlim100
##   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1     1     A SZ(-TR)  0.16       16    4.000
## 2     2     A SZ(-TR)  0.11       11    3.317
## 3     3     A SZ(-TR)  0.10       10    3.162
## 4     4     A SZ(-TR)  0.16       16    4.000
## 5     5     A SZ(-TR)  0.15       15    3.873
## 6     6     A SZ(+TR)  0.12       12    3.464</pre>

</article></slide><slide class=''><hgroup><h2>Боксплоты числа улиток</h2></hgroup><article  id="--">

<p>Нормальное ли тут распределение?</p>

<pre class = 'prettyprint lang-r'>ggplot(data = minch, aes(x = site, y = limpt100)) +
  geom_boxplot() +
  labs(y = &quot;Число улиток на 100 устриц&quot;, 
       x = &quot;Сайт&quot;)</pre>

<p><img src="02_power_files/figure-html/unnamed-chunk-14-1.png" width="384" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2>Боксплот корня из численности улиток (<strong>sqlim100</strong>) для двух сайтов<br /></h2></hgroup><article  id="-----sqlim100---">

<pre class = 'prettyprint lang-r'>ggplot(data = minch, aes(x = site, y = sqlim100)) +
  geom_boxplot() +
  labs(y = &quot;Число улиток на 100 устриц&quot;, 
       x = &quot;Сайт&quot;)</pre>

<p><img src="02_power_files/figure-html/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;" /></p>

<ul class = 'build'>
<li>Распределение стало больше походить на нормальное. Можно пользоваться t-критерием для сравнения значений корня из численности улиток (<strong>sqlim100</strong>) для двух сайтов.</li>
</ul>

</article></slide><slide class='segue dark nobackground level1'><hgroup class = 'auto-fadein'><h2>A priory анализ мощности по данным пилотного исследования</h2></hgroup><article  id="a-priory------">

</article></slide><slide class=''><hgroup><h2>Анализ мощности по данным пилотного исследования</h2></hgroup><article  id="-----">

<p>Представим, что эти данные &#8212; это данные пилотного исследования.</p>

<p>Мы хотим выяснить по этим данным, сколько нужно собрать проб, чтобы показать, что плотность улиток различается на двух сайтах.</p>

<h3>Величина эффекта по исходным данным</h3>

<pre class = 'prettyprint lang-r'>library(effsize)
eff_snail &lt;- cohen.d(minch$sqlim100, minch$site)
eff_snail</pre>

<pre >## 
## Cohen&#39;s d
## 
## d estimate: -0.3650246 (small)
## 95 percent confidence interval:
##       inf       sup 
## -1.027557  0.297508</pre>

<pre class = 'prettyprint lang-r'># Вычислим модуль, поскольку для `pwr.t.test()` эффект должен быть положительным
effect_snail &lt;- abs(eff_snail$estimate)</pre>

</article></slide><slide class=''><hgroup><h2>Задание</h2></hgroup><article  id="-2">

<p>Рассчитайте объем выборки, чтобы показать различия плотности улиток между сайтами с вероятностью 0.8?</p>

<p>Используйте функцию <code>pwr.t.test()</code></p>

</article></slide><slide class=''><hgroup><h2>Решение</h2></hgroup><article  id="-2">

<pre class = 'prettyprint lang-r'>pwr_snail &lt;- pwr.t.test(n = NULL, d = effect_snail, power = 0.8, sig.level = 0.05, type = &quot;two.sample&quot;, alternative = &quot;two.sided&quot;)
pwr_snail</pre>

<pre >## 
##      Two-sample t test power calculation 
## 
##               n = 118.7808
##               d = 0.3650246
##       sig.level = 0.05
##           power = 0.8
##     alternative = two.sided
## 
## NOTE: n is number in *each* group</pre>

<ul class = 'build'>
<li>Нужна выборка <strong>119 площадок с каждого сайта</strong>, чтобы с вероятностью 0.8 обнаружить различия плотности улиток между сайтами.</li>
</ul>

</article></slide><slide class=''><hgroup><h2>Задание</h2></hgroup><article  id="-3">

<p>Представьте, что в датасете <strong>sleep</strong> содержатся данные пилотного исследования.</p>

<p>Оцените, какой объем выборки нужно взять, чтобы показать, что число часов дополнительного сна после применения двух препаратов различается?</p>

</article></slide><slide class=''><hgroup><h2>Решение</h2></hgroup><article  id="-3">

<pre class = 'prettyprint lang-r'>eff_sleep &lt;- cohen.d(sleep$extra, sleep$group)
effect_sleep &lt;- abs(eff_sleep$estimate)
pwr_sleep &lt;- pwr.t.test(n = NULL, d = effect_sleep, power = 0.8, sig.level = 0.05, type = &quot;two.sample&quot;, alternative = &quot;two.sided&quot;)
pwr_sleep</pre>

<pre >## 
##      Two-sample t test power calculation 
## 
##               n = 23.6672
##               d = 0.8321811
##       sig.level = 0.05
##           power = 0.8
##     alternative = two.sided
## 
## NOTE: n is number in *each* group</pre>

<p>Нужна выборка <strong>24 человека в каждой из групп</strong>, чтобы с вероятностью 0.8 обнаружить различия числа часов дополнительного сна после применения двух препаратов.</p>

</article></slide><slide class='segue dark nobackground level1'><hgroup class = 'auto-fadein'><h2>Как влиять на мощность теста?</h2></hgroup><article  id="----">

</article></slide><slide class=''><hgroup><h2>Чем больше объем выборки &#8212; тем больше мощность</h2></hgroup><article  id="----------">

<p><img src="02_power_files/figure-html/pwr_vs_n-1.png" width="960" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2>Чем больше уровень значимости &#8212; тем больше мощность</h2></hgroup><article  id="----------">

<p><img src="02_power_files/figure-html/unnamed-chunk-19-1.png" width="960" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2>Чем больше величина различий &#8212; тем больше мощность</h2></hgroup><article  id="----------">

<p><img src="02_power_files/figure-html/unnamed-chunk-20-1.png" width="960" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2>Каким образом можно повлиять на мощность теста?</h2></hgroup><article  id="------">

<ul>
<li>Мощность теста можно регулировать, если

<ul>
<li>изменить число повторностей</li>
<li>выбрать другой уровень значимости (\(\alpha\))</li>
<li>определиться, какие эффекты действительно важны (\(ES\))</li>
</ul></li>
</ul>

</article></slide><slide class=''><hgroup><h2>Take home messages</h2></hgroup><article  id="take-home-messages">

<ul>
<li>Чтобы не находить несуществующих эффектов, фиксируем уровень значимости</li>
<li>Чтобы не пропустить значимое, рассчитываем величину эффекта, объем выборки и мощность теста</li>
<li>Способность выявлять различия зависит

<ul>
<li>от объема выборки,</li>
<li>от уровня значимости</li>
<li>от величины эффекта</li>
</ul></li>
</ul>

</article></slide><slide class=''><hgroup><h2>Дополнительные ресурсы</h2></hgroup><article  id="-">

<ul>
<li>Quinn, Keough, 2002, pp. 164-170</li>
<li>Open Intro to Statistics: <a href='http://www.openintro.org/stat/down/oiStat2_04.pdf' title=''>4.6 Sample Size and Power</a>, pp. 193-197</li>
<li>Sokal, Rohlf, 1995, pp. 167-169.</li>
<li>Zar, 1999, p. 83.</li>
<li><a href='http://www.ats.ucla.edu/stat/r/dae/t_test_power2.htm' title=''>R Data Analysis Examples - Power Analysis for Two-group Independent sample t-test. UCLA: Statistical Consulting Group.</a></li>
<li><a href='http://www.ats.ucla.edu/stat/r/dae/t_test_power.htm' title=''>R Data Analysis Examples - Power Analysis for One-sample t-test. UCLA: Statistical Consulting Group.</a></li>
<li><a href='http://www.ats.ucla.edu/stat/mult_pkg/faq/general/effect_size_power/effect_size_power.htm' title=''>FAQ - How is effect size used in power analysis? UCLA: Statistical Consulting Group.</a></li>
</ul></article></slide>


  <slide class="backdrop"></slide>

</slides>

<script src="site_libs/ioslides-13.5.1/js/modernizr.custom.45394.js"></script>
<script src="site_libs/ioslides-13.5.1/js/prettify/prettify.js"></script>
<script src="site_libs/ioslides-13.5.1/js/prettify/lang-r.js"></script>
<script src="site_libs/ioslides-13.5.1/js/prettify/lang-yaml.js"></script>
<script src="site_libs/ioslides-13.5.1/js/hammer.js"></script>
<script src="site_libs/ioslides-13.5.1/js/slide-controller.js"></script>
<script src="site_libs/ioslides-13.5.1/js/slide-deck.js"></script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!-- map slide visiblity events into shiny -->
<script>
  (function() {
    if (window.jQuery) {
       window.jQuery(document).on('slideleave', function(e) {
         window.jQuery(e.target).trigger('hidden');
      });
       window.jQuery(document).on('slideenter', function(e) {
         window.jQuery(e.target).trigger('shown');
      });
    }
  })();
</script>

</body>
</html>
